language: python
dist: xenial
python:
  - "3.6.7"
before_install:
    - sudo apt-get -o Acquire::https::No-Cache=True -o Acquire::http::No-Cache=True update -qq
    - sudo apt-get install python-bluetooth -qq -y
    - pip install pyserial==3.1.1
    - pip install coveralls
install: pip install -q -e .
script: python setup.py test
after_success:
  - coverage run --source=openxc setup.py test
  - coveralls
deploy:
  provider: pypi
  server: https://test.pypi.org/
  user: "__token__"
  password: "AgENdGVzdC5weXBpLm9yZwIkMDNiZDRkZjktYWFjYi00ODk5LThlMjktZWRmODljYjdjZDY0AAI3eyJwZXJtaXNzaW9ucyI6IHsicHJvamVjdHMiOiBbIm9wZW54YyJdfSwgInZlcnNpb24iOiAxfQAABiCTWq8FC8zwVyoNsHqCx182ivnqu9edr03cr7ui6ywhrw"
  on:
    all_branches: true
